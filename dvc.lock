schema: '2.0'
stages:
  prepare_train_input:
    cmd:
    - python concat_reports.py ../data/feathered/
    deps:
    - path: ../data/feathered/
      md5: 689806ca7931c99d68994d28ba4015e6.dir
      size: 1740730474
      nfiles: 13
    - path: ../feature_handling/feature_handler.json
      md5: 73f0566e372f9ea1afdf89cbb7ad816e
      size: 41861
    - path: ../mldq/feature_handler.py
      md5: 3ef83d0afb83cce70b1bc2e163848fa0
      size: 14103
    - path: ../mldq/params.py
      md5: edbe52eb8c2150cae39bb569e5a341af
      size: 1880
    - path: ../mldq/simple_script.py
      md5: 7bc61defb132c56824b9257e6d2b7cd3
      size: 7413
    - path: concat_reports.py
      md5: c187d6d17b58e92d40c49b7287f0cdbd
      size: 2261
    params:
      params.yaml:
        prepare_train_input:
          feature_handler_file: ../feature_handling/feature_handler.json
    outs:
    - path: train_input/
      md5: a151a3ad75fc98a6c1e61aa8756d5971.dir
      size: 232061690
      nfiles: 1
  train:
    cmd:
    - python scripts/train_autoembedder.py ./data/training_input/
    deps:
    - path: ./autoembedder/
      md5: f99fcc2c03cafef24be7946c51733747.dir
      size: 37491
      nfiles: 5
    - path: ./data/training_input/
      md5: 76518463305c60240aba1a1514d686a0.dir
      size: 12754
      nfiles: 1
    - path: ./feature_handling/feature_handler.json
      md5: 070f9288be784dc10bfabf9626d828fd
      size: 2365
    - path: ./utils/feature_handler.py
      md5: 4bd8400f2e2c620f11b68b30d7f1c12f
      size: 12163
    - path: scripts/train_autoembedder.py
      md5: 7e14a071591310234d69f70ef6bfa34b
      size: 5979
    params:
      params.yaml:
        train_model:
          feature_handler_file: ./feature_handling/feature_handler.json
          manual_encoder_architecture:
          - 4
          - 4
          - 2
          manual_decoder_architecture: []
          activation_function: ReLU
          test_data_fraction: 0.2
          embeddings_initializer: uniform
          optimizer: adam
          loss: mse
          batch_size: 32
          epochs: 100
          learning_rate: 0.05
    outs:
    - path: ./data/model/
      md5: 8831c650462ef96892acf36b9730ff8b.dir
      size: 273748
      nfiles: 4
  test:
    cmd:
    - python scripts/test_autoembedder.py ./data/training_input/ ./data/model/autoembedder
    deps:
    - path: ./autoembedder/
      md5: 018d78e19a0059bbe0f6bd667c222755.dir
      size: 37491
      nfiles: 5
    - path: ./data/model/
      md5: b70764264840a5169de6041c54391ff8.dir
      size: 274238
      nfiles: 4
    - path: ./data/training_input/
      md5: 76518463305c60240aba1a1514d686a0.dir
      size: 12754
      nfiles: 1
    - path: scripts/test_autoembedder.py
      md5: 83dd0e25eb86ab19fe680cebba96e953
      size: 1562
    params:
      params.yaml:
        test_model:
          feature_handler_file: ./feature_handling/feature_handler.json
          batch_size: 9
  data_preprocessing:
    cmd:
    - python scripts/preprocess_data.py
    deps:
    - path: ./feature_handling/feature_actions.json
      md5: 861bff553bc372dc5cc343e909f69b4f
      size: 79
    - path: scripts/preprocess_data.py
      md5: 9be17c606a7d20ecee1bc47c02c69d9e
      size: 3144
    - path: utils/feature_handler.py
      md5: 4bd8400f2e2c620f11b68b30d7f1c12f
      size: 12163
    - path: utils/params.py
      md5: edbe52eb8c2150cae39bb569e5a341af
      size: 1880
    params:
      params.yaml:
        data_preprocessing:
          feature_handler_dir: ./feature_handling/
          feature_action_file: ./feature_handling/feature_actions.json
    outs:
    - path: data/training_input/
      md5: 76518463305c60240aba1a1514d686a0.dir
      size: 12754
      nfiles: 1
    - path: feature_handling/feature_handler.json
      md5: dfb240b251b8a11fa558492ebc47fe47
      size: 2456
    - path: feature_handling/feature_handler_pretty_summary.json
      md5: 85530058600ceb2075fc5fa4246b76da
      size: 594
  train_autoembedder:
    cmd:
    - python scripts/train_autoembedder.py ./data/training_input/
    deps:
    - path: ./autoembedder/
      md5: e9a73252f491fba26b668e49fe5ea434.dir
      size: 47675
      nfiles: 7
    - path: ./data/training_input/
      md5: 76518463305c60240aba1a1514d686a0.dir
      size: 12754
      nfiles: 1
    - path: ./feature_handling/feature_handler.json
      md5: dfb240b251b8a11fa558492ebc47fe47
      size: 2456
    - path: ./utils/feature_handler.py
      md5: 4bd8400f2e2c620f11b68b30d7f1c12f
      size: 12163
    - path: scripts/train_autoembedder.py
      md5: 281a16baeeffcb1ec16074655bf365b8
      size: 7000
    params:
      params.yaml:
        train_autoembedder:
          feature_handler_file: ./feature_handling/feature_handler.json
          manual_encoder_architecture: []
          manual_decoder_architecture: []
          activation_function: ReLU
          test_data_fraction: 0.2
          embeddings_initializer: uniform
          normalisation_method: manual
          optimizer: adam
          loss: mse
          learning_rate: 0.05
          metric:
          - accuracy
          - precision
          batch_size: 32
          epochs: 100
    outs:
    - path: ./data/model/
      md5: 5c84efb7b936f5b886c3601eedac74cf.dir
      size: 268034
      nfiles: 4
  train_supervised_classification_embedding:
    cmd:
    - python scripts/supervised_classification_wembedding.py ./data/training_input/
    deps:
    - path: ./data/training_input/
      md5: 76518463305c60240aba1a1514d686a0.dir
      size: 12754
      nfiles: 1
    - path: ./scripts/supervised_classification_wembedding.py
      md5: 439c1951d58dffd34f653f0ec0ea5d64
      size: 4644
    params:
      params.yaml:
        train_simple_classification_model:
          feature_handler_file: ./feature_handling/feature_handler.json
          activation_function: ReLU
          normalisation_method: manual
          test_data_fraction: 0.2
          embeddings_initializer: uniform
          optimizer: adam
          loss: cce
          learning_rate: 0.1
          metrics:
          - accuracy
          batch_size: 32
          epochs: 100
  train_supervised_classification_autoembedding:
    cmd:
    - python scripts/supervised_classification_wautoembedding.py ./data/training_input/
      ./data/model/autoembedder
    deps:
    - path: ./data/training_input/
      md5: 76518463305c60240aba1a1514d686a0.dir
      size: 12754
      nfiles: 1
    - path: ./scripts/supervised_classification_wautoembedding.py
      md5: eabf5cbf3663d467f9d24801c5a640f3
      size: 4115
    params:
      params.yaml:
        train_simple_classification_model:
          feature_handler_file: ./feature_handling/feature_handler.json
          activation_function: ReLU
          normalisation_method: manual
          test_data_fraction: 0.2
          embeddings_initializer: uniform
          optimizer: adam
          loss: cce
          learning_rate: 0.1
          metrics:
          - accuracy
          batch_size: 32
          epochs: 100
